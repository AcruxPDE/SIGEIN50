-- =============================================
-- Proyecto: Sistema SIGEIN 5.0
-- Copyright (c) - Acrux - 2015
-- Author: Gabriel Vázquez
-- CREATE date: 20/01/2016
-- Description: Insercion de variables de la prueba TIVA
-- =============================================
CREATE PROCEDURE [IDP].[SPE_INSERTA_RESPUESTAS_APTITUD1]
	@XML_RESULTADO XML = '' OUT      --APLICA PARA REGRESAR UN NÚMERO 0 PARA ERROR Y 1 PARA CORRECTO
	,@PIN_XML_RESULTADOS AS XML
	,@PIN_ID_CUESTIONARIO AS INT = NULL
	,@PIN_NB_PRUEBA AS NVARCHAR(50)
	,@PIN_ID_PRUEBA AS INT
	,@PIN_CL_USUARIO_APP AS NVARCHAR(50)
	,@PIN_NB_PROGRAMA AS NVARCHAR(50)

AS
BEGIN  
	--SE DECLARA E INICIALIZA LA VARIABLE QUE NOS INDICARA SI GENERAMOS LA TRANSACCION EN ESTE SP
	DECLARE @V_EXIST_TRAN BIT = 0
    	BEGIN TRY
		--SE VERIFICA SI EXISTE UNA TRANSACCION EN EJECUCION
		IF (@@TRANCOUNT = 0) 
		BEGIN
			--EN CASO DE QUE NO SE INICIALIZA LA TRANSACCION
			BEGIN TRANSACTION
			--SE EDITA LA VARIABLE QUE INDICA QUE SE INICIO LA TRANSACCION EN ESTE BLOQUE PARA CANCELARLA SI ES NECESARIO
			SET @V_EXIST_TRAN = 1
		END	
		--SE VERIFICA SI SE INSERTA EL REGISTRO O SE ACTUALIZARA SEGUN LA VARIABLE DE TIPO DE TRANSACCION  QUE RECIBE EL SP
		IF @PIN_ID_CUESTIONARIO IS NULL BEGIN

			SELECT @PIN_ID_CUESTIONARIO = ID_CUESTIONARIO
			FROM IDP.K_PRUEBA
			WHERE ID_PRUEBA = @PIN_ID_PRUEBA

		END


		IF @PIN_NB_PRUEBA = 'APTITUD11' BEGIN
		
			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122)

			-- PONER AQUI EL DELETE DE LAS VARIABLES QUE YA SE QUE SE VAN A INSERTAR
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 107 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 108 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*2*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 109 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 110 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 111 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 112 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 113 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 114 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 115 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 116 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 117 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 118 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*12*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 119 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*13*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 120 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*14*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 121 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*15*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 122 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*16*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-A-0016'
			
		END

		IF @PIN_NB_PRUEBA = 'APTITUD12' BEGIN
			
			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 123 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 124 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*2*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 125 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 126 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 127 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 128 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 129 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 130 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 131 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 132 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 133 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-B-0011'
			
		END

		IF @PIN_NB_PRUEBA = 'APTITUD13' BEGIN

			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (134, 135 ,136 ,137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 134 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 135 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*2*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 136 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 137 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 138 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 139 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 140 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 141 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 142 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 143 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 144 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 145 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*12*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 146 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*13*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 147 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*14*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 148 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*15*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 149 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*16*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0016'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 150 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*17*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0017'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 151 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*18*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0018'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 152 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*19*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0019'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 153 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*20*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0020'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 154 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*21*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0021'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 155 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*22*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0022'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 156 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*23*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0023'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 157 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*24*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0024'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 158 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*25*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0025'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 159 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*26*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0026'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 160 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*27*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0027'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 161 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*28*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0028'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 162 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*29*/ WHEN 'O' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0029'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 163 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*30*/ WHEN 'I' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-C-0030'
			
		END

		IF @PIN_NB_PRUEBA = 'APTITUD14' BEGIN
			
			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 164 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN 'be' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 165 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*2*/ WHEN 'ac' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 166 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN 'cd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 167 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN 'ac' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 168 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN 'be' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 169 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN 'ce' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 170 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN 'be' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 171 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN 'be' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 172 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN 'ab' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 173 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN 'ac' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 174 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN 'bc' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 175 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*12*/ WHEN 'ab' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 176 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*13*/ WHEN 'ce' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 177 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*14*/ WHEN 'ad' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 178 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*15*/ WHEN 'ab' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 179 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*16*/ WHEN 'be' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0016'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 180 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*17*/ WHEN 'ab' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0017'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 181 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*18*/ WHEN 'cd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-D-0018'

		END

		IF @PIN_NB_PRUEBA = 'APTITUD15' BEGIN
		/* VERIFICAR ALGUNOS RESULTDO LOS MANDA EN DECIMAL */
			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 182 AS ID_VARIABLE,/*1*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '20' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 183 AS ID_VARIABLE,/*2*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '11' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 184 AS ID_VARIABLE,/*3*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '50' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 185 AS ID_VARIABLE,/*4*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '50' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 186 AS ID_VARIABLE,/*5*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '120' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 187 AS ID_VARIABLE,/*6*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '19.2' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 188 AS ID_VARIABLE,/*7*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '500' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 189 AS ID_VARIABLE,/*8*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '2' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 190 AS ID_VARIABLE,/*9*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '28' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 191 AS ID_VARIABLE,/*10*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '360' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 192 AS ID_VARIABLE,/*11*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '2' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 193 AS ID_VARIABLE,/*12*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '25' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-E-0012'

		END

		IF @PIN_NB_PRUEBA = 'APTITUD16' BEGIN
			
			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 194 AS ID_VARIABLE,/*1*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 195 AS ID_VARIABLE,/*2*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 196 AS ID_VARIABLE,/*3*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 197 AS ID_VARIABLE,/*4*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 198 AS ID_VARIABLE,/*5*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 199 AS ID_VARIABLE,/*6*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 200 AS ID_VARIABLE,/*7*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 201 AS ID_VARIABLE,/*8*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 202 AS ID_VARIABLE,/*9*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 203 AS ID_VARIABLE,/*10*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 204 AS ID_VARIABLE,/*11*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 205 AS ID_VARIABLE,/*12*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 206 AS ID_VARIABLE,/*13*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 207 AS ID_VARIABLE,/*14*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 208 AS ID_VARIABLE,/*15*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 209 AS ID_VARIABLE,/*16*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0016'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 210 AS ID_VARIABLE,/*17*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0017'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 211 AS ID_VARIABLE,/*18*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '0' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0018'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 212 AS ID_VARIABLE,/*19*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0019'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 213 AS ID_VARIABLE,/*20*/ CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE -1 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-F-0020'

		END

		IF @PIN_NB_PRUEBA = 'APTITUD17' BEGIN

			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 214 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 215 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*2*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 216 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 217 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 218 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 219 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 220 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 221 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 222 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 223 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 224 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 225 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*12*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 226 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*13*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 227 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*14*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 228 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*15*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 229 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*16*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0016'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 230 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*17*/ WHEN 'b' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0017'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 231 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*18*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0018'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 232 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*19*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0019'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 233 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*20*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-G-0020'

		END

		IF @PIN_NB_PRUEBA = 'APTITUD18' BEGIN
			
			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 234 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 235 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*2*/ WHEN 'F' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 236 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 237 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 238 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 239 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN 'F' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 240 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN 'F' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 241 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 242 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 243 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN 'F' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 244 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN 'F' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 245 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*12*/ WHEN 'F' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 246 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*13*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 247 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*14*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 248 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*15*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 249 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*16*/ WHEN 'V' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0016'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 250 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*17*/ WHEN 'F' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-H-0017'

		END


		IF @PIN_NB_PRUEBA = 'APTITUD19' BEGIN

			/*REVISAR  ALGUNOS ESTA MAL*/
			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268)

			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 251 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0001'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 252 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*2*/ WHEN 'e' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0002'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 253 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0003'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 254 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0004'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 255 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0005'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 256 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0006'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 257 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN 'e' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0007'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 258 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0008'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 259 AS ID_VARIABLE,CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0009'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 260 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN 'c' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0010'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 261 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN 'e' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0011'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 262 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*12*/ WHEN 'e' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 263 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*13*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 264 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*14*/ WHEN 'e' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 265 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*15*/ WHEN 'e' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 266 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*16*/ WHEN 'a' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0016'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 267 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*17*/ WHEN 'd' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0017'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 268 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*17*/ WHEN 'e' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-I-0018'

		END

		IF @PIN_NB_PRUEBA = 'APTITUD110' BEGIN
			
			/* VERIFICAR. Listo: se cambio por texbox normales */

			DELETE IDP.K_RESULTADO WHERE ID_CUESTIONARIO = @PIN_ID_CUESTIONARIO AND ID_VARIABLE IN (269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279)

			/* Variable 1 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*1*/ WHEN '2' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0001' ) = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') WHEN '1' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0002') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 269 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0001'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 269 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA
			END

			/* Variable 2*/
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*3*/ WHEN '33' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0003') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*4*/ WHEN '38' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0004') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 270 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0002'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 270 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0002'
			END

			/* Variable 3*/
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*5*/ WHEN '64' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0005') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*6*/ WHEN '128' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0006') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 271 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0003'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 271 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0003'
			END

			/* Varible 4 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*7*/ WHEN '2' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0007') = 1 AND ( SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*8*/ WHEN '2' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0008') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 272 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0004'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 272 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0004'
			END

			/* Variable 5 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*9*/ WHEN '13' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0009') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*10*/ WHEN '13.1/4' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0010') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 273 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0005'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 273 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0005'
			END

			/* Variable 6 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)')/*11*/ WHEN '20' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0011') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*12*/WHEN '21' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0012') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 274 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0006'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 274 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0006'
			END

			/* Variable 7*/
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*13*/WHEN '1/4' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0013') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*14*/WHEN '1/8' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0014') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 275 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0007'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 275 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0007'
			END

			/* Variable 8 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*15*/WHEN '85.3' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0015') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*16*/WHEN '94.3' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0016') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 276 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0008'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 276 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0008'
			END

			/* Variable 9 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*17*/WHEN '6' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0017') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*18*/WHEN '8' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0018') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 277 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0009'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 277 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0009'
			END

			/* Variable 10 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*19*/WHEN '33' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0019') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*20*/WHEN '34' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0020') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 278 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0010'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 278 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0010'
			END

			/* Variable 11 */
			IF (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*21*/WHEN '25' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0021') = 1 AND (SELECT CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*22*/WHEN '125' THEN 1 ELSE 0 END AS NO_VALOR FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0022') = 1 BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 279 AS ID_VARIABLE, 1 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0011'
			END ELSE BEGIN
				INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 279 AS ID_VARIABLE, 0 AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA --FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0011'
			END
			
			/*
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1003 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*12*/WHEN '21' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0012'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1004 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*13*/WHEN '1/4' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0013'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1005 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*14*/WHEN '1/8' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0014'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1006 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*15*/WHEN '85.3' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0015'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1007 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*16*/WHEN '94.3' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0016'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1008 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*17*/WHEN '6' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0017'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1009 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*18*/WHEN '8' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0018'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1010 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*19*/WHEN '33' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0019'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1011 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*20*/WHEN '34' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0020'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1012 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*21*/WHEN '25' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0021'
			INSERT INTO [IDP].[K_RESULTADO]([CL_TIPO_RESULTADO],[ID_VARIABLE],[NO_VALOR],[ID_CUESTIONARIO],[FE_CREACION],[CL_USUARIO_APP_CREA],[NB_PROGRAMA_CREA]) SELECT 1 AS CL_TIPO_RESULTADO, 1013 AS ID_VARIABLE, CASE d.value('@NB_RESPUESTA', 'NVARCHAR(50)') /*22*/WHEN '125' THEN 1 ELSE 0 END AS NO_VALOR, @PIN_ID_CUESTIONARIO, GETDATE(), @PIN_CL_USUARIO_APP, @PIN_NB_PROGRAMA FROM @PIN_XML_RESULTADOS.nodes('RESPUESTAS/RESPUESTA') AS T(d) WHERE d.value('@CL_VARIABLE', 'NVARCHAR(50)') = 'APTITUD1-J-0022'
			*/
		END

		--SE DEVUELVE LA VARIABLE DE RETORNO INDICANDO QUE TODO SE REALIZO CORRECTAMENTE
		SET @XML_RESULTADO = DBO.F_ERROR_CREAR_ENCABEZADO( @@ROWCOUNT, 1, 'SUCCESSFUL')
		SET @XML_RESULTADO = DBO.F_ERROR_INSERTAR_MENSAJES(@XML_RESULTADO, 'Proceso exitoso', 'ES')
		SET @XML_RESULTADO = DBO.F_ERROR_INSERTAR_MENSAJES(@XML_RESULTADO, 'Successful Process', 'EN')
		--SI SE GENERO UNA TRANSACCION EN ESTE BLOQUE LA TERMINARA
		IF (@@TRANCOUNT > 0 AND @V_EXIST_TRAN = 1)
			COMMIT
	END TRY
	BEGIN CATCH
		--SI OCURRIO UN ERROR Y SE INICIO UNA TRANSACCION ENE ESTE BLOQUE SE CANCELARA LA TRANSACCION
		IF (@@TRANCOUNT > 0 AND @V_EXIST_TRAN = 1)
			ROLLBACK
		--SE INDICA EN LA VARIABLE DE RETORNO QUE OCURRIO UN ERROR
		--SET @POUT_CLAVE_RETORNO = 0
		--SE INSERTA EL ERROR EN LA TABLA
		DECLARE @ERROR_CLAVE INT  = ERROR_NUMBER()
		DECLARE @ERROR_MENSAJE NVARCHAR(250)  = ERROR_MESSAGE()
		--print ERROR_MESSAGE()
		SET @XML_RESULTADO = DBO.F_ERROR_CREAR_ENCABEZADO( @@ROWCOUNT, @ERROR_CLAVE, 'ERROR')
		SET @XML_RESULTADO = DBO.F_ERROR_MENSAJES(@ERROR_CLAVE,@ERROR_MENSAJE)
		SET @XML_RESULTADO = DBO.F_ERROR_MENSAJES(@ERROR_CLAVE,@ERROR_MENSAJE)
	END CATCH
END


